include "../utils.dfy"

import opened Utils

lemma algebra_sqineq_2unitcircatblt1(a: real, b: real)
  requires a * a + b * b == 2.0
  ensures a * b <= 1.0
{
  calc {
    a * a + b * b == 2.0;
    (a * a + b * b) / 2.0 == 1.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - 2.0 * (a * b) / 2.0 + (a * a + b * b) / 2.0 == 1.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - (a * b) + 1.0 == 1.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - (a * b) == 0.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) >= 0.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - (a * b) >= 0.0;
    - (a * b) >= - ((a + b) / 2.0) * ((a + b) / 2.0);
    a * b <= ((a + b) / 2.0) * ((a + b) / 2.0);
    ((a + b) / 2.0) * ((a + b) / 2.0) <= ((a * a + b * b) / 2.0 + 2.0 * (a * b) / 2.0) / 2.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) <= (1.0 + a * b) / 2.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - a * b / 2.0 <= 1.0 / 2.0;
    ((a + b) / 2.0) * ((a + b) / 2.0) - a * b / 2.0 <= 0.5;
    a * b <= 1.0;
  }
}