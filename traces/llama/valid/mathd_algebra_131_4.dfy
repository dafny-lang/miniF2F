include "../utils.dfy"

import opened Utils

lemma mathd_algebra_131(a: real, b: real, f: real -> real)
  requires forall x :: f(x) == 2.0*x*x - 7.0*x + 2.0
  requires f(a) == 0.0
  requires f(b) == 0.0
  requires a != b
  ensures 1.0/(a - 1.0) + 1.0/(b - 1.0) == -1.0
{
  calc {
    1.0/(a - 1.0) + 1.0/(b - 1.0) ==
    (b - 1.0 + a - 1.0) / ((a - 1.0) * (b - 1.0));
    (b - 1.0 + a - 1.0) / ((a - 1.0) * (b - 1.0)) ==
    (a + b - 2.0) / (a * b - a - b + 1.0);
    a * b - a - b + 1.0 ==
    a * b - a - b + 1.0;
    a * b - a - b + 1.0 ==
    (a * b - 7.0 * a + 2.0) + (a - 2.0) + (b - 2.0) + 1.0;
    (a * b - 7.0 * a + 2.0) + (a - 2.0) + (b - 2.0) + 1.0 ==
    f(a) + (a - 2.0) + (b - 2.0) + 1.0;
    f(a) + (a - 2.0) + (b - 2.0) + 1.0 ==
    0.0 + (a - 2.0) + (b - 2.0) + 1.0;
    0.0 + (a - 2.0) + (b - 2.0) + 1.0 ==
    (a - 2.0) + (b - 2.0) + 1.0;
    (a - 2.0) + (b - 2.0) + 1.0 ==
    (a - 2.0) + (b - 2.0) + 1.0;
    (a - 2.0) + (b - 2.0) + 1.0 ==
    (2.0 * a * a - 7.0 * a + 2.0) / (2.0 * a) +
    (2.0 * b * b - 7.0 * b + 2.0) / (2.0 * b);
    (2.0 * a * a - 7.0 * a + 2.0) / (2.0 * a) +
    (2.0 * b * b - 7.0 * b + 2.0) / (2.0 * b) ==
    (2.0 * a - 7.0 + 2.0 / a) + (2.0 * b - 7.0 + 2.0 / b);
    (2.0 * a - 7.0 + 2.0 / a) + (2.0 * b - 7.0 + 2.0 / b) ==
    (2.0 * a - 7.0 + 2.0 / a) + (2.0 * b - 7.0 + 2.0 / b);
    (2.0 * a - 7.0 + 2.0 / a) + (2.0 * b - 7.0 + 2.0 / b) ==
    f(a) / a + f(b) / b;
    f(a) / a + f(b) / b ==
    0.0 / a + 0.0 / b;
    0.0 / a + 0.0 / b ==
    0.0;
    0.0 ==
    -1.0 * (a - 1.0) * (b - 1.0);
    -1.0 * (a - 1.0) * (b - 1.0) ==
    -1.0 * (a * b - a - b + 1.0);
    -1.0 * (a * b - a - b + 1.0) ==
    -1.0;
  }
}